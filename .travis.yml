language: python
python: 3.6

matrix:
  include:
    - sudo: false
      dist: trusty
      env: INSTALL=no TESTFILE=./wftests/warrior_tests/projects/pj_common_actions.xml
    - sudo: false
      dist: trusty
      env: INSTALL=yes TESTFILE=./wftests/ci/pylint.sh PYLINT=yes
    - sudo: false
      dist: trusty
      env: INSTALL=yes TESTFILES_1=yes
    - sudo: false
      dist: trusty
      env: INSTALL=yes TESTFILES_2=yes
    - sudo: false
      dist: trusty
      env: INSTALL=no TESTFILE=./wftests/warrior_tests/testcases/framework_tests/cond_var/pass.xml COPILOT=yes

install:
  - if [[ ${COPILOT} = "yes" ]]; then
      pip3 install --upgrade setuptools ;
      python3 setup.py install ;
    fi
  - if [[ ${INSTALL} = "yes" ]] && [[ ! -z ${TRAVIS_PULL_REQUEST_BRANCH} ]]; then

      pip3 install pexpect==4.8.0;
      pip3 install requests==2.21.0;
    pip3 install selenium==3.8.0;
    pip3 install lxml==4.4.1;
    pip3 install  paramiko==2.4.2;
    pip3 install pysnmp==4.4.9;
     pip3 install pyvirtualdisplay==0.2.1;
    pip3 install kafka-python==1.4.6;
     pip3 install cloudshell-automation-api==9.3.0.175525;
      pip3 install  pycryptodome==3.6.1;
    pip3 install Django==2.1.2;
    pip3 install xmltodict==0.12.0;
     pip3 install python-ldap;
    pip3 install django_auth_ldap;
    pip3 install djangorestframework==3.10.3;
    pip3 install gcg==0.2.0;
    pip3 install termcolor==1.1.0;



    fi
script:
  - if [[ -z ${TRAVIS_PULL_REQUEST_BRANCH} ]]; then
      python3 ./warrior/Warrior ./wftests/warrior_tests/testcases/framework_tests/cond_var/pass.xml ;
    elif [[ ${PYLINT} = "yes" ]]; then
      $TESTFILE ;
    elif [[ ${TESTFILES_1} = "yes" ]]; then
      python3 ./warrior/Warrior ./wftests/warrior_tests/projects/pj_framework_tests.xml ;
      python3 ./warrior/Warrior ./wftests/warrior_tests/projects/pj_rest.xml ;
      python3 ./warrior/Warrior  ./wftests/warrior_tests/projects/pj_retry.xml ;
      python3 ./warrior/Warrior   ./wftests/warrior_tests/projects/pj_glob.xml ;
      python3 ./warrior/Warrior  ./wftests/warrior_tests/projects/pj_runmode_retry_at_suite_level_at_project_file.xml;
      python3 ./warrior/Warrior ./wftests/warrior_tests/projects/pj_execute_resume.xml ;

    elif [[ ${TESTFILES_2} = "yes" ]]; then
      python3 ./warrior/Warrior ./wftests/warrior_tests/projects/pj_cond_var.xml ./wftests/warrior_tests/projects/pj_iterative_execution.xml ./wftests/warrior_tests/projects/pj_parallel_execution.xml ./wftests/warrior_tests/projects/pj_parallel_execution_2.xml ;
    else
      python3 ./warrior/Warrior $TESTFILE ;
    fi

after_success:
  - if [[ ${COPILOT} = "yes" ]]; then
      bash <(curl -s https://copilot.blackducksoftware.com/ci/travis/scripts/upload);
    fi
